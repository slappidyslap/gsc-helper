# GSC Helper

GSC Helper — это модульный Java-проект, позволяющий собирать данные поисковой аналитики из Google Search Console (далее просто GSC),
формировать отчет и передавать его на дальнейшую обработку.

Текущая версия включает готовый графический интерфейс GUI на Swing
для сбора метрик GSC по нескольким сайтам за выбранный период и сохранение результатов в формате файла Excel.

Благодаря модульности, поверх ядра можно создавать другие клиенты.
Например, CLI утилиту, веб интерфейс на Vue, Nuxt или Kotlin Multiplatform.

## Возможности

*   **Интеграция с Google Search Console:** Аутентификация с GSC API для получения списков сайтов и данных поисковой аналитики.
*   **Сбор метрик:** Собирает ключевые метрики (клики, показы, CTR, средняя позиция) для всех подтвержденных сайтов в течение заданного пользователем диапазона дат.
*   **Генерация отчетов XLSX:** Экспортирует собранные метрики GSC в хорошо отформатированный файл Excel (XLSX).
*   **Обработка ошибок:** Корректно обрабатывает ошибки API и неподтвержденные сайты во время сбора данных, сообщая о них в отчете.
*   **Удобный графический интерфейс:** Интерфейс на базе Swing упрощает процесс выбора диапазонов дат и сохранения отчетов.



## Модули

Проект состоит из следующих модулей:

*   **`gsc-helper-api`**: Этот модуль определяет **контракты (интерфейсы)** и модели данных.
Он полностью абстрагирован от конкретных реализаций, что позволяет легко заменять
или добавлять новые функциональные возможности.

*   **`gsc-helper-core`**: Содержит базовые реализации интерфейсов из `gsc-helper-api`.
Например, есть реализации логика для работы с GSC API, сборки XLSX-таблиц и сохранения их в локальные файлы.

*   **`gsc-helper-swing-gui`**: Графический интерфейс на Swing, который использует реализации из `gsc-helper-core`
для предоставления функциональности конечному пользователю.



## Архитектура

Ключевая особенность проекта — его архитектура, построенная на абстракциях в модуле `gsc-helper-api`.
Это позволяет легко расширять и адаптировать проект под различные нужды.

### 1. Формат отчетов (`TableBuilder`)

Иерархия интерфейсов `TableBuilder` позволяет создавать отчеты в разных форматах.
На текущий момент присутствует реализация `ApachePoiXlsxBuilder` в `core`-модуле,
которая генерирует XLSX файлы, используя библиотеку Apache POI.

Однако, благодаря абстракции, можно легко добавить новые реализации, например:

*   `JsonTableBuilder` для данных в формате JSON.

*   `CsvTableBuilder` для данных в формате CSV.


### 2. Обработка выходного отчета (`TableDataOutputProcessor`)

Интерфейс `TableDataOutputProcessor` отвечает за обработку сгенерированного отчета (представленного в виде байтового массива).
Фабрика `TableDataOutputProcessorFactory` позволяет создавать различные обработчики в зависимости от конфигурации.

Текущая реализация `TableDataOutputLocalFileSaver` просто сохраняет байтовый массив в файл.
В будущем можно добавить обработчики, которые:

* Отправляют отчет по электронной почте.

* Загружают его на удаленный сервер.

* Отправляют в мессенджеры, такие как Slack.

* Упоминает сотрудников в Jira.


### 3. Способы аутентификации GSC (`GscApiBuilder`)

`GscApiBuilder` — это абстракция для создания клиента GSC API. В `core`-модуле есть `GscApiAuthorizationCodeFlowBuilder`,
который реализует аутентификацию через OAuth 2.0 Authorization Code Flow (требует участия пользователя через браузер).

Эта абстракция позволяет в будущем реализовать другие способы аутентификации, например, для CLI приложения,
где браузер не всегда присутствует.

Более того, сам процесс аутентификации зависит от других абстракций, таких как `GscAuthCredentialsLoader`.
В `core`-модуле есть следующие реализации: 

* `GscAuthLocalFileCredentialsLoader` загружает `credentials.json` (файл учетных данных доступа) из локальной файловой системы.

* `GscAuthInputStreamCredentialsLoader` загружает файл `credentials.json` как `InputStream`.
Это надёжный способ, когда приложение запускается из JAR файла (ресурсы внутри JAR не являются обычными файлами
и не имеют физического пути)

Контрибьюторы могут предложить свои реализации, которые загружают файлы учетных данных доступа:

* С удаленного сервера.

* Из переменных окружения.

* Из защищенного хранилища.



## Начало работы

**Важно:** GSC Helper построен как модульная платформа, а не как одно монолитное приложение.
Ядро (`gsc-helper-api` и `gsc-helper-core`) предоставляет всю логику интеграции с Google Search Console
и генерации отчётов, а поверх него можно создавать различные клиенты.

На данный момент проект включает одну готовую реализацию клиента — Swing GUI (`gsc-helper-swing-gui`).

Ниже приведены инструкции по запуску текущего клиента Swing GUI.

### Swing GUI

#### Предварительные требования

* Java Development Kit (JDK) 8 или выше  
* Maven 3.x  
* Проект Google Cloud с включённым Search Console API  
* Файл учётных данных `credentials.json`, который должен быть помещён в  
  `gsc-helper-swing-gui/src/main/resources`

#### Сборка проекта

Этот проект использует Maven. Чтобы собрать все модули, перейдите в корневой каталог проекта и выполните:

```bash
mvn clean install
```

Это скомпилирует код, запустит тесты и упакует модули в JAR файлы. Модуль `gsc-helper-swing-gui` создаст Fat-JAR
в каталоге `target`.

#### Запуск

После сборки проекта вы можете запустить приложение Swing GUI из каталога `target` модуля `gsc-helper-swing-gui`:

```bash
java -jar "gsc-helper-swing-gui/target/GSC Helper Swing GUI.jar"
```

или

```bash
./mvnw --projects gsc-helper-swing-gui --quiet compile exec:java
```

Запустится графический интерфейс, позволяющий выбрать диапазон дат и место сохранения отчета о метриках GSC.

<img src="https://github.com/user-attachments/assets/eeccfe5b-b303-443f-aba9-2b8e3b216c4b" />

